<!-- Good morning, Mr. Phelps. -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>or-tools/src/constraint_solver/mtsearch.cc Source File - Doxy</title>
    <link rel="shortcut icon" href="../../../favicon.ico">
    <!-- Both stylesheets are supplied by Doxygen, with maybe minor tweaks from Google. -->
    <link href="../../../doxygen.css" rel="stylesheet" type="text/css">
    <link href="../../../tabs.css" rel="stylesheet" type="text/css">
  </head>

  <body topmargin=0 leftmargin=20 bottommargin=0 rightmargin=20 marginwidth=20 marginheight=0>

  <table width=100% cellpadding=0 cellspacing=0 border=0>
    <!-- Top horizontal line with the color of the day. -->
    <tr valign=top>
      <td colspan=3 bgcolor=#992252 height=3></td>
    </tr>

    <!-- Header row with the links at the right. -->
    <tr valign=top>
      <td colspan=3 align=right>
        <font size=-1>
          Generated on: <font color=#992252><b>Fri Aug 10 02:28:15 CEST 2012</b></font>
            for Revision:2056
        </font>
      </td>
    </tr>

    <!-- Header row with the logo and the search form. -->
    <tr valign=top>
      <!-- Logo. -->
      <td align=left width=150>
        <table width=150 height=54 cellpadding=0 cellspacing=0 border=0>
          <tr valign=top>
            <!-- First part of the secret behind Doxy logo always having the word "Doxy" with the color of the day. -->
            <td>
              <a class="doxy_logo" href="../../../index.html"><img src="../../../doxy_logo.png" alt="OR-Tools" border=0></a>
            </td>
          </tr>
        </table>
      </td>
    </tr>

    <!-- Tiny vertical space below the form. -->
    <tr valign=top>
      <td colspan=3 height=3></td>
    </tr>
  </table>

  <!-- Header navigation row. -->
  <div class="memproto">
    <table width=100% cellpadding=0 cellspacing=0 border=0>
      <tr>
        <td align=left style="padding-left: 20px"><font size=+1><b><tt><font color=#333333>//
            <a href="../../../index.html"><font color=#992252>doxy</font></a>/</font>
            <a href="../../../or-tools/index.html">or-tools</a>/
            <a href="../../../or-tools/src/index.html">src</a>/
            <a href="../../../or-tools/src/constraint_solver/index.html">constraint_solver</a>/
            </tt></b></font>
        </td>
      </tr>
    </table>
  </div>
  <br />
    <!-- No subdirs found. -->
  <!-- End of header. -->
<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">or-tools/src/constraint_solver/mtsearch.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mtsearch_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright 2010-2012 Google</span>
<a name="l00002"></a>00002 <span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00003"></a>00003 <span class="comment">// you may not use this file except in compliance with the License.</span>
<a name="l00004"></a>00004 <span class="comment">// You may obtain a copy of the License at</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//     http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// Unless required by applicable law or agreed to in writing, software</span>
<a name="l00009"></a>00009 <span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00010"></a>00010 <span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00011"></a>00011 <span class="comment">// See the License for the specific language governing permissions and</span>
<a name="l00012"></a>00012 <span class="comment">// limitations under the License.</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;stddef.h&gt;</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;base/callback.h&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;base/commandlineflags.h&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;base/integral_types.h&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;base/logging.h&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;base/mutex.h&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;base/scoped_ptr.h&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;base/synchronization.h&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;base/threadpool.h&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;constraint_solver/assignment.pb.h&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="constraint__solver_8h.html">constraint_solver/constraint_solver.h</a>&quot;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <a class="code" href="default__search_8cc.html#a096c1c951b391cf2f9a54d3c74f0e211" title="Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in c...">DEFINE_int32</a>(cp_parallel_update_frequency, 16,
<a name="l00028"></a>00028              <span class="stringliteral">&quot;frequency to update the local solution with the foreign &quot;</span>
<a name="l00029"></a>00029              <span class="stringliteral">&quot;one stored on the master.&quot;</span>);
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keyword">namespace </span>operations_research {
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="comment">// ----- Headers -----</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">// This class acts as a glue between the master and different workers</span>
<a name="l00036"></a>00036 <span class="comment">// in a multi thread environment. It offers synchronization services</span>
<a name="l00037"></a>00037 <span class="comment">// and help creates the different objects needed by the searches.</span>
<a name="l00038"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html">00038</a> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a> : <span class="keyword">public</span> <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html" title="MultiThread and distributed LNS.">ParallelSolveSupport</a> {
<a name="l00039"></a>00039  <span class="keyword">public</span>:
<a name="l00040"></a>00040   <a class="code" href="classoperations__research_1_1MtSolveSupport.html#af6eda3cef6466078b6dfdd2a7fb4a954" title="MtSolveSupport.">MtSolveSupport</a>(<span class="keywordtype">int</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a27fcf0904422ef0d413cb3eae0dcdfbd" title="Returns the number of workers (master + slaves).">workers</a>,
<a name="l00041"></a>00041                  <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#aeecb19dc2b21ea4d2f1aca5bf7f77f88" title="Are we maximizing the search.">maximize</a>,
<a name="l00042"></a>00042                  <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a334247bbbaecd6234d26177c960296a5">ModelBuilder</a>* <span class="keyword">const</span> run_model);
<a name="l00043"></a>00043 
<a name="l00044"></a>00044   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2ff4d966a2609b00dc51a2c5b88ef36f">~MtSolveSupport</a>();
<a name="l00045"></a>00045 
<a name="l00046"></a>00046   <span class="comment">// This method is used by slaves to wait for the initial solution to</span>
<a name="l00047"></a>00047   <span class="comment">// be found by the master. If the return value is false, then no</span>
<a name="l00048"></a>00048   <span class="comment">// solution has been found and the slave should exit gracefully.</span>
<a name="l00049"></a>00049   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#aa1c009b7d6399132a888003e7a1bf919" title="This method is used by slaves to wait for the initial solution to be found by the master...">WaitForInitialSolution</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> to_fill, <span class="keywordtype">int</span> worker);
<a name="l00050"></a>00050 
<a name="l00051"></a>00051   <span class="comment">// This method is used be the master to signal the initial solution</span>
<a name="l00052"></a>00052   <span class="comment">// to workers.</span>
<a name="l00053"></a>00053   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#af7b234f656e7b76152f0c838ca4803f3" title="This method is used be the master to signal the initial solution to workers.">RegisterInitialSolution</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> to_save);
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   <span class="comment">// This method is used by the master to signal that no initial</span>
<a name="l00056"></a>00056   <span class="comment">// solution has been found.</span>
<a name="l00057"></a>00057   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a31b6a1131bb7d3441f9b13435e997df6" title="This method is used by the master to signal that no initial solution has been found.">RegisterNoInitialSolution</a>();
<a name="l00058"></a>00058 
<a name="l00059"></a>00059   <span class="comment">// Creates a decision builder for the master. This decision builder</span>
<a name="l00060"></a>00060   <span class="comment">// will print out each solutions found by the slaves.</span>
<a name="l00061"></a>00061   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a95020cfa50666bf042f562030646c9cb" title="Creates a decision builder for the master.">MakeReplayDecisionBuilder</a>(
<a name="l00062"></a>00062       <a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s, <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#acc85a6eb86b33445e74fede5bfdb2f6c" title="Returns the best stored solution.">solution</a>);
<a name="l00063"></a>00063 
<a name="l00064"></a>00064   <span class="comment">// A simple shortcut to create the search log only on the master.</span>
<a name="l00065"></a>00065   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#adf300ee4f00170b7cb485150ac827398" title="A simple shortcut to create the search log only on the master.">MakeSearchLog</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00066"></a>00066                                        <span class="keywordtype">bool</span> master,
<a name="l00067"></a>00067                                        int64 freq,
<a name="l00068"></a>00068                                        <a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> objective);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070   <span class="comment">// A simple shortcut to create the limit only on the workers and not</span>
<a name="l00071"></a>00071   <span class="comment">// on the master.</span>
<a name="l00072"></a>00072   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae1276216e0dc2e9cd262beb9991d276c" title="A simple shortcut to create the limit only on the workers and not on the master.">MakeLimit</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00073"></a>00073                                    <span class="keywordtype">bool</span> master,
<a name="l00074"></a>00074                                    int64 time_limit,
<a name="l00075"></a>00075                                    int64 branch_limit,
<a name="l00076"></a>00076                                    int64 fail_limit,
<a name="l00077"></a>00077                                    int64 solution_limit);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   <span class="comment">// Creates a search monitor that communicates solutions found by the</span>
<a name="l00080"></a>00080   <span class="comment">// slaves to the master. Both master and slaves should use this.</span>
<a name="l00081"></a>00081   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ad5551f220950e91a13a3104528566117" title="Creates a search monitor that communicates solutions found by the slaves to the master.">MakeCommunicationMonitor</a>(
<a name="l00082"></a>00082       <a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00083"></a>00083       <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution,
<a name="l00084"></a>00084       <span class="keywordtype">bool</span> master,
<a name="l00085"></a>00085       <span class="keywordtype">int</span> worker);
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   <span class="comment">// Creates a solution pool to be used in the Local Search for each</span>
<a name="l00088"></a>00088   <span class="comment">// worker. This solution pool is responsible for pulling improved</span>
<a name="l00089"></a>00089   <span class="comment">// solution from the master.</span>
<a name="l00090"></a>00090   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1SolutionPool.html" title="SolutionPool.">SolutionPool</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2d6e2559008f09e5d97b9bdc3896e72c" title="Creates a solution pool to be used in the Local Search for each worker.">MakeSolutionPool</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s, <span class="keywordtype">int</span> worker);
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#ab9c48a8e943687f08d9f13598d886fe2">00092</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ab9c48a8e943687f08d9f13598d886fe2" title="This method launches the computation that will itself call the run_model callback given to the constr...">Run</a>() {
<a name="l00093"></a>00093     ThreadPool pool(<span class="stringliteral">&quot;Parallel_LNS&quot;</span>, workers_ + 1);
<a name="l00094"></a>00094     pool.StartWorkers();
<a name="l00095"></a>00095     <span class="comment">// Start master.</span>
<a name="l00096"></a>00096     pool.Add(NewCallback(
<a name="l00097"></a>00097         <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#aeecb8deef4520ae74c8029731fd82746" title="Callback to run the model.">run_model_</a>.get(),
<a name="l00098"></a>00098         &amp;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#ab9c48a8e943687f08d9f13598d886fe2" title="This method launches the computation that will itself call the run_model callback given to the constr...">ModelBuilder::Run</a>,
<a name="l00099"></a>00099         <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classoperations__research_1_1ParallelSolveSupport.html" title="MultiThread and distributed LNS.">ParallelSolveSupport</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>),
<a name="l00100"></a>00100         <span class="keyword">true</span>,
<a name="l00101"></a>00101         -1));
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="pack_8cc.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a> = 0; <a class="code" href="pack_8cc.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a> &lt; workers_; ++<a class="code" href="pack_8cc.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>) {
<a name="l00104"></a>00104       pool.Add(NewCallback(
<a name="l00105"></a>00105           <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#aeecb8deef4520ae74c8029731fd82746" title="Callback to run the model.">run_model_</a>.get(),
<a name="l00106"></a>00106           &amp;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#ab9c48a8e943687f08d9f13598d886fe2" title="This method launches the computation that will itself call the run_model callback given to the constr...">ModelBuilder::Run</a>,
<a name="l00107"></a>00107           <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classoperations__research_1_1ParallelSolveSupport.html" title="MultiThread and distributed LNS.">ParallelSolveSupport</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>),
<a name="l00108"></a>00108           <span class="keyword">false</span>,
<a name="l00109"></a>00109           <a class="code" href="pack_8cc.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>));
<a name="l00110"></a>00110     }
<a name="l00111"></a>00111   }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <span class="comment">// Returns the number of workers (master + slaves).</span>
<a name="l00114"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a27fcf0904422ef0d413cb3eae0dcdfbd">00114</a>   <span class="keywordtype">int</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a27fcf0904422ef0d413cb3eae0dcdfbd" title="Returns the number of workers (master + slaves).">workers</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> workers_; }
<a name="l00115"></a>00115 
<a name="l00116"></a>00116   <span class="comment">// Internal</span>
<a name="l00117"></a>00117   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ad31ae945c0f0c3c3a55f1afb680b960d" title="Internal.">MasterApplyReplayer</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s, <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution);
<a name="l00118"></a>00118   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a9b3d746bcdab6c4f5ff00fa83f779fe0">MasterRefuteReplayer</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s, <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution);
<a name="l00119"></a>00119   <a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a5230b35e5d03927322889cbf5aadc810">MasterNextDecision</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s, <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2232e645164d443b5d6babb692201d22">MasterEnterSearch</a>();
<a name="l00122"></a>00122   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a662ed2e91422cafdc3d5e013d06914aa">MasterExitSearch</a>();
<a name="l00123"></a>00123 
<a name="l00124"></a>00124   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#aaf4ea3c5a9df67835824731f0fbf525f">SlaveEnterSearch</a>(<span class="keywordtype">int</span> worker);
<a name="l00125"></a>00125   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a962b1d0f7d9d69a10c216bb8845377ca">SlaveExitSearch</a>(<span class="keywordtype">int</span> worker);
<a name="l00126"></a>00126   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ada37e0fb50bc0a9b0004c57a4ea34891">SlaveNotifySolution</a>(<span class="keywordtype">int</span> worker, <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   <span class="comment">// Compare local solution with the shared one.</span>
<a name="l00129"></a>00129   <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#af33157d7b2315fd26838236bc8564da7" title="Compare local solution with the shared one.">IsSharedSolutionBetter</a>(int64 current_value) <span class="keyword">const</span>;
<a name="l00130"></a>00130   <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae31e02a3d31836e432fdb886471db366">IsSharedSolutionWorse</a>(int64 current_value) <span class="keyword">const</span>;
<a name="l00131"></a>00131 
<a name="l00132"></a>00132   <span class="comment">// Locks the internal mutex.</span>
<a name="l00133"></a>00133   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a91dfb33b24119c2195a4865174bdec8f" title="Locks the internal mutex.">LockMutex</a>();
<a name="l00134"></a>00134   <span class="comment">// Unlocks the internal mutex.</span>
<a name="l00135"></a>00135   <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae5ce3e3e55087bedbe55e4345d7e8ca2" title="Unlocks the internal mutex.">UnlockMutex</a>();
<a name="l00136"></a>00136 
<a name="l00137"></a>00137  <span class="keyword">private</span>:
<a name="l00138"></a>00138   <span class="keywordtype">bool</span> CheckTermination();
<a name="l00139"></a>00139   <span class="keywordtype">void</span> Reset();
<a name="l00140"></a>00140   <span class="keywordtype">void</span> BlockBarrier(scoped_ptr&lt;Barrier&gt;* barrier_ptr) {
<a name="l00141"></a>00141     <span class="keywordflow">if</span> ((*barrier_ptr)-&gt;Block()) {
<a name="l00142"></a>00142       barrier_ptr-&gt;reset(<span class="keyword">new</span> Barrier(workers_ + 1));
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144   }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <span class="comment">// Total number of workers.</span>
<a name="l00147"></a>00147   <span class="keyword">const</span> <span class="keywordtype">int</span> workers_;
<a name="l00148"></a>00148   <span class="comment">// Global mutex.</span>
<a name="l00149"></a>00149   Mutex mutex_;
<a name="l00150"></a>00150   <span class="comment">// Condition var to awaken master after a new solution.</span>
<a name="l00151"></a>00151   CondVar cond_var_;
<a name="l00152"></a>00152   <span class="comment">// Cost of best solution reported by the master search.</span>
<a name="l00153"></a>00153   int64 best_exported_cost_;
<a name="l00154"></a>00154   <span class="comment">// Is the master blocked awaiting a better solution.</span>
<a name="l00155"></a>00155   <span class="keywordtype">bool</span> master_blocked_;
<a name="l00156"></a>00156   <span class="comment">// Initial barrier after the search for the first solution.</span>
<a name="l00157"></a>00157   scoped_ptr&lt;Barrier&gt; solution_barrier_;
<a name="l00158"></a>00158   <span class="comment">// Initial barrier when all slaves enter search.</span>
<a name="l00159"></a>00159   scoped_ptr&lt;Barrier&gt; enter_search_barrier_;
<a name="l00160"></a>00160   <span class="comment">// Initial barrier when all slaves exit search.</span>
<a name="l00161"></a>00161   scoped_ptr&lt;Barrier&gt; exit_search_barrier_;
<a name="l00162"></a>00162   <span class="comment">// Fail stamp of the last reported solution in the master search.</span>
<a name="l00163"></a>00163   uint64 fail_stamp_;
<a name="l00164"></a>00164   <span class="comment">// How many slaves have started.</span>
<a name="l00165"></a>00165   <span class="keywordtype">int</span> started_slaves_;
<a name="l00166"></a>00166   <span class="comment">// How many slaves have stopped.</span>
<a name="l00167"></a>00167   <span class="keywordtype">int</span> ended_slaves_;
<a name="l00168"></a>00168 };
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 <span class="comment">// This class is used in the master search to replay the best solution</span>
<a name="l00173"></a>00173 <span class="comment">// so far in the apply branch.</span>
<a name="l00174"></a><a class="code" href="classoperations__research_1_1MtReplaySolution.html">00174</a> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1MtReplaySolution.html" title="This class is used in the master search to replay the best solution so far in the apply branch...">MtReplaySolution</a> : <span class="keyword">public</span> <a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a> {
<a name="l00175"></a>00175  <span class="keyword">public</span>:
<a name="l00176"></a><a class="code" href="classoperations__research_1_1MtReplaySolution.html#a70c530be6c19a975d74c654cef66689a">00176</a>   <a class="code" href="classoperations__research_1_1MtReplaySolution.html#a70c530be6c19a975d74c654cef66689a">MtReplaySolution</a>(<a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support,
<a name="l00177"></a>00177                  <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution)
<a name="l00178"></a>00178       : support_(support), solution_(solution) {}
<a name="l00179"></a><a class="code" href="classoperations__research_1_1MtReplaySolution.html#a47524a658998253ef60a5c07df8126dd">00179</a>   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1MtReplaySolution.html#a47524a658998253ef60a5c07df8126dd">~MtReplaySolution</a>() {}
<a name="l00180"></a>00180 
<a name="l00181"></a><a class="code" href="classoperations__research_1_1MtReplaySolution.html#a06e034480f400906a7c51bb969c7e5c7">00181</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtReplaySolution.html#a06e034480f400906a7c51bb969c7e5c7" title="Apply will be called first when the decision is executed.">Apply</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver) {
<a name="l00182"></a>00182     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#ad31ae945c0f0c3c3a55f1afb680b960d" title="Internal.">MasterApplyReplayer</a>(solver, solution_);
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184 
<a name="l00185"></a><a class="code" href="classoperations__research_1_1MtReplaySolution.html#a1889210ec6fd9bb5b90bd5b5681e394a">00185</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtReplaySolution.html#a1889210ec6fd9bb5b90bd5b5681e394a" title="Refute will be called after a backtrack.">Refute</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver) {
<a name="l00186"></a>00186     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#a9b3d746bcdab6c4f5ff00fa83f779fe0">MasterRefuteReplayer</a>(solver, solution_);
<a name="l00187"></a>00187   }
<a name="l00188"></a>00188  <span class="keyword">private</span>:
<a name="l00189"></a>00189   <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support_;
<a name="l00190"></a>00190   <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution_;
<a name="l00191"></a>00191 };
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="comment">// This decision builder replays the solutions found by the slaves.</span>
<a name="l00194"></a><a class="code" href="classoperations__research_1_1MtReplayer.html">00194</a> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1MtReplayer.html" title="This decision builder replays the solutions found by the slaves.">MtReplayer</a> : <span class="keyword">public</span> <a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a> {
<a name="l00195"></a>00195  <span class="keyword">public</span>:
<a name="l00196"></a><a class="code" href="classoperations__research_1_1MtReplayer.html#a081f1039d915f2802b612b7dd4f0903b">00196</a>   <a class="code" href="classoperations__research_1_1MtReplayer.html#a081f1039d915f2802b612b7dd4f0903b">MtReplayer</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver,
<a name="l00197"></a>00197            <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support,
<a name="l00198"></a>00198            <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution)
<a name="l00199"></a>00199       : support_(support),
<a name="l00200"></a>00200         solution_(solver-&gt;MakeAssignment(solution)) {}
<a name="l00201"></a><a class="code" href="classoperations__research_1_1MtReplayer.html#a717e58a744ac432e280038c2699b5623">00201</a>   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1MtReplayer.html#a717e58a744ac432e280038c2699b5623">~MtReplayer</a>() {}
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="classoperations__research_1_1MtReplayer.html#aca7911a52f993316c71d89a9cba53c12">00203</a>   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <a class="code" href="classoperations__research_1_1MtReplayer.html#aca7911a52f993316c71d89a9cba53c12" title="This is the main method of the decision builder class.">Next</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver) {
<a name="l00204"></a>00204     <span class="keywordflow">return</span> support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#a5230b35e5d03927322889cbf5aadc810">MasterNextDecision</a>(solver, solution_);
<a name="l00205"></a>00205   }
<a name="l00206"></a>00206  <span class="keyword">private</span>:
<a name="l00207"></a>00207   <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support_;
<a name="l00208"></a>00208   <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution_;
<a name="l00209"></a>00209 };
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="comment">// This search monitor is used to synchronize the master and the</span>
<a name="l00212"></a>00212 <span class="comment">// slaves at the beginning of the search.</span>
<a name="l00213"></a><a class="code" href="classoperations__research_1_1MtSolutionReceiver.html">00213</a> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1MtSolutionReceiver.html" title="This search monitor is used to synchronize the master and the slaves at the beginning of the search...">MtSolutionReceiver</a> : <span class="keyword">public</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a> {
<a name="l00214"></a>00214  <span class="keyword">public</span>:
<a name="l00215"></a><a class="code" href="classoperations__research_1_1MtSolutionReceiver.html#a7493f9ce0967da7741801e7bf3fadff2">00215</a>   <a class="code" href="classoperations__research_1_1MtSolutionReceiver.html#a7493f9ce0967da7741801e7bf3fadff2">MtSolutionReceiver</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#ab7032463a55bd7d196d1fefde47f0238">solver</a>, <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support)
<a name="l00216"></a>00216       : <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>(solver), support_(support) {}
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classoperations__research_1_1MtSolutionReceiver.html#a0952c3e782a3ae3d81bc23de79850b4e">00218</a>   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1MtSolutionReceiver.html#a0952c3e782a3ae3d81bc23de79850b4e">~MtSolutionReceiver</a>() {}
<a name="l00219"></a>00219 
<a name="l00220"></a><a class="code" href="classoperations__research_1_1MtSolutionReceiver.html#a93f3d68e8f30b0915937b5599a7cf534">00220</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolutionReceiver.html#a93f3d68e8f30b0915937b5599a7cf534" title="Beginning of the search.">EnterSearch</a>() {
<a name="l00221"></a>00221     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2232e645164d443b5d6babb692201d22">MasterEnterSearch</a>();
<a name="l00222"></a>00222   }
<a name="l00223"></a><a class="code" href="classoperations__research_1_1MtSolutionReceiver.html#a4867e4b60fdd2722aa5b6788b0112bb9">00223</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolutionReceiver.html#a4867e4b60fdd2722aa5b6788b0112bb9" title="End of the search.">ExitSearch</a>() {
<a name="l00224"></a>00224     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#a662ed2e91422cafdc3d5e013d06914aa">MasterExitSearch</a>();
<a name="l00225"></a>00225   }
<a name="l00226"></a>00226  <span class="keyword">private</span>:
<a name="l00227"></a>00227   <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support_;
<a name="l00228"></a>00228 };
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <span class="comment">// This class is used to to synchronize the master and the search at</span>
<a name="l00231"></a>00231 <span class="comment">// the beginning of the search. It is also used to report solutions</span>
<a name="l00232"></a>00232 <span class="comment">// from the slaves to the master.</span>
<a name="l00233"></a><a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html">00233</a> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html" title="This class is used to to synchronize the master and the search at the beginning of the search...">MtSolutionDispatcher</a> : <span class="keyword">public</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a> {
<a name="l00234"></a>00234  <span class="keyword">public</span>:
<a name="l00235"></a><a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#ad135ff2bbd6e5c39534fdcf46583f30c">00235</a>   <a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#ad135ff2bbd6e5c39534fdcf46583f30c">MtSolutionDispatcher</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#ab7032463a55bd7d196d1fefde47f0238">solver</a>,
<a name="l00236"></a>00236                      <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support,
<a name="l00237"></a>00237                      <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> assignment,
<a name="l00238"></a>00238                      <span class="keywordtype">int</span> worker)
<a name="l00239"></a>00239       : <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>(solver),
<a name="l00240"></a>00240         support_(support),
<a name="l00241"></a>00241         assignment_(solver-&gt;MakeAssignment(assignment)),
<a name="l00242"></a>00242         worker_(worker) {}
<a name="l00243"></a>00243 
<a name="l00244"></a><a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#a19000f3374ea161802e8a75f30842de1">00244</a>   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#a19000f3374ea161802e8a75f30842de1">~MtSolutionDispatcher</a>() {}
<a name="l00245"></a>00245 
<a name="l00246"></a><a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#aa316fbf540dc88ff4ddcb6adf62d072e">00246</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#aa316fbf540dc88ff4ddcb6adf62d072e" title="Beginning of the search.">EnterSearch</a>() {
<a name="l00247"></a>00247     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#aaf4ea3c5a9df67835824731f0fbf525f">SlaveEnterSearch</a>(worker_);
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249 
<a name="l00250"></a><a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#a9b8b43bd635be5378f93801344dc9102">00250</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#a9b8b43bd635be5378f93801344dc9102" title="End of the search.">ExitSearch</a>() {
<a name="l00251"></a>00251     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#a962b1d0f7d9d69a10c216bb8845377ca">SlaveExitSearch</a>(worker_);
<a name="l00252"></a>00252   }
<a name="l00253"></a>00253 
<a name="l00254"></a><a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#a2c744371656a78530f9b352108f8087c">00254</a>   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html#a2c744371656a78530f9b352108f8087c" title="This method is called when a valid solution is found.">AtSolution</a>() {
<a name="l00255"></a>00255     assignment_-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#a7eb289b0a73f7cdb6296c26f485eb69e">Store</a>();
<a name="l00256"></a>00256     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#ada37e0fb50bc0a9b0004c57a4ea34891">SlaveNotifySolution</a>(worker_, assignment_);
<a name="l00257"></a>00257     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00258"></a>00258   }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260  <span class="keyword">private</span>:
<a name="l00261"></a>00261   <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support_;
<a name="l00262"></a>00262   <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> assignment_;
<a name="l00263"></a>00263   <span class="keyword">const</span> <span class="keywordtype">int</span> worker_;
<a name="l00264"></a>00264 };
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="comment">// ---------- Implementation ----------</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="comment">// ----- ParallelSolveSupport -----</span>
<a name="l00269"></a>00269 
<a name="l00270"></a><a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#abe61c7d79d20230f428dbdd802dbc35d">00270</a> <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#abe61c7d79d20230f428dbdd802dbc35d" title="Implementation.">ParallelSolveSupport::ParallelSolveSupport</a>(
<a name="l00271"></a>00271     <span class="keywordtype">bool</span> maximize,
<a name="l00272"></a>00272     <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a334247bbbaecd6234d26177c960296a5">ModelBuilder</a>* <span class="keyword">const</span> run_model)
<a name="l00273"></a>00273   : local_solution_(new AssignmentProto()),
<a name="l00274"></a>00274     <a class="code" href="hybrid_8cc.html#ad5d09a69c6c8c8eea9311b0513628683">maximize_</a>(maximize),
<a name="l00275"></a>00275     run_model_(run_model) {
<a name="l00276"></a>00276   run_model-&gt;CheckIsRepeatable();
<a name="l00277"></a>00277   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;mutable_worker_info()-&gt;set_worker_id(-1);
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00280"></a><a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#aa83748843a1a2dc2528d3452fa3be7bf">00280</a> <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#aa83748843a1a2dc2528d3452fa3be7bf">ParallelSolveSupport::~ParallelSolveSupport</a>() {}
<a name="l00281"></a>00281 
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="comment">// ----- MtSolveSupport -----</span>
<a name="l00284"></a>00284 
<a name="l00285"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#af6eda3cef6466078b6dfdd2a7fb4a954">00285</a> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#af6eda3cef6466078b6dfdd2a7fb4a954" title="MtSolveSupport.">MtSolveSupport::MtSolveSupport</a>(
<a name="l00286"></a>00286     <span class="keywordtype">int</span> workers,
<a name="l00287"></a>00287     <span class="keywordtype">bool</span> maximize,
<a name="l00288"></a>00288     <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a334247bbbaecd6234d26177c960296a5">ParallelSolveSupport::ModelBuilder</a>* <span class="keyword">const</span> run_model)
<a name="l00289"></a>00289     : <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html" title="MultiThread and distributed LNS.">ParallelSolveSupport</a>(maximize, run_model),
<a name="l00290"></a>00290       workers_(workers),
<a name="l00291"></a>00291       best_exported_cost_(<a class="code" href="hybrid_8cc.html#ad5d09a69c6c8c8eea9311b0513628683">maximize_</a> ? kint64min : kint64max),
<a name="l00292"></a>00292       master_blocked_(false),
<a name="l00293"></a>00293       solution_barrier_(new Barrier(workers_ + 1)),
<a name="l00294"></a>00294       enter_search_barrier_(new Barrier(workers_ + 1)),
<a name="l00295"></a>00295       exit_search_barrier_(new Barrier(workers_ + 1)),
<a name="l00296"></a>00296       <a class="code" href="dependency__graph_8cc.html#a8ca05b086f171637a3db5ceac193956e">fail_stamp_</a>(0ULL),
<a name="l00297"></a>00297       started_slaves_(0),
<a name="l00298"></a>00298       ended_slaves_(0) {
<a name="l00299"></a>00299   Reset();
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="namespaceoperations__research.html#a133ba82ca7608c70849fdcfe54fee680">00302</a> <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html" title="MultiThread and distributed LNS.">ParallelSolveSupport</a>* <a class="code" href="namespaceoperations__research.html#a133ba82ca7608c70849fdcfe54fee680" title="This method creates an instance of ParallelSolveSupport suited for multi-threaded computation...">MakeMtSolveSupport</a>(
<a name="l00303"></a>00303     <span class="keywordtype">int</span> workers,
<a name="l00304"></a>00304     <span class="keywordtype">bool</span> maximize,
<a name="l00305"></a>00305     <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a334247bbbaecd6234d26177c960296a5">ParallelSolveSupport::ModelBuilder</a>* <span class="keyword">const</span> model_builder) {
<a name="l00306"></a>00306   <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>(workers, maximize, model_builder);
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2ff4d966a2609b00dc51a2c5b88ef36f">00309</a> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2ff4d966a2609b00dc51a2c5b88ef36f">MtSolveSupport::~MtSolveSupport</a>() {}
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="keywordtype">void</span> MtSolveSupport::Reset() {
<a name="l00312"></a>00312   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Calling reset on MtSolveSupport&quot;</span>;
<a name="l00313"></a>00313   started_slaves_ = 0;
<a name="l00314"></a>00314   ended_slaves_ = 0;
<a name="l00315"></a>00315   master_blocked_ = <span class="keyword">false</span>;
<a name="l00316"></a>00316   best_exported_cost_ = <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#aeecb19dc2b21ea4d2f1aca5bf7f77f88" title="Are we maximizing the search.">maximize</a>() ? kint64min : kint64max;
<a name="l00317"></a>00317   fail_stamp_ = 0ULL;
<a name="l00318"></a>00318   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;mutable_worker_info()-&gt;set_worker_id(-1);
<a name="l00319"></a>00319   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;set_is_valid(<span class="keyword">false</span>);
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a91dfb33b24119c2195a4865174bdec8f">00322</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a91dfb33b24119c2195a4865174bdec8f" title="Locks the internal mutex.">MtSolveSupport::LockMutex</a>() EXCLUSIVE_LOCK_FUNCTION(mutex_) {
<a name="l00323"></a>00323   mutex_.Lock();
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00326"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae5ce3e3e55087bedbe55e4345d7e8ca2">00326</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae5ce3e3e55087bedbe55e4345d7e8ca2" title="Unlocks the internal mutex.">MtSolveSupport::UnlockMutex</a>() UNLOCK_FUNCTION(mutex_) {
<a name="l00327"></a>00327   mutex_.Unlock();
<a name="l00328"></a>00328 }
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#aa1c009b7d6399132a888003e7a1bf919">00330</a> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#aa1c009b7d6399132a888003e7a1bf919" title="This method is used by slaves to wait for the initial solution to be found by the master...">MtSolveSupport::WaitForInitialSolution</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> to_fill,
<a name="l00331"></a>00331                                             <span class="keywordtype">int</span> worker) {
<a name="l00332"></a>00332   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;worker &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; waiting for initial solution&quot;</span>;
<a name="l00333"></a>00333   BlockBarrier(&amp;solution_barrier_);
<a name="l00334"></a>00334   <span class="keywordflow">if</span> (<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;is_valid()) {
<a name="l00335"></a>00335     to_fill-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#ae25cd4c0ce5b86a12bdf6b71e9f97201" title="Loads an assignment from a file; does not add variables to the assignment (only the variables contain...">Load</a>(*<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>);
<a name="l00336"></a>00336     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;worker &quot;</span> &lt;&lt; worker
<a name="l00337"></a>00337             &lt;&lt; <span class="stringliteral">&quot; receiving initial solution with value &quot;</span>
<a name="l00338"></a>00338             &lt;&lt; to_fill-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#ae8fb42916395ec84bbc1c5a73838bb44">ObjectiveValue</a>();
<a name="l00339"></a>00339     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00340"></a>00340   } <span class="keywordflow">else</span> {
<a name="l00341"></a>00341     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;worker &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; has not received a solution&quot;</span>;
<a name="l00342"></a>00342     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00343"></a>00343   }
<a name="l00344"></a>00344 }
<a name="l00345"></a>00345 
<a name="l00346"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#af7b234f656e7b76152f0c838ca4803f3">00346</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#af7b234f656e7b76152f0c838ca4803f3" title="This method is used be the master to signal the initial solution to workers.">MtSolveSupport::RegisterInitialSolution</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> to_save) {
<a name="l00347"></a>00347   CHECK(to_save);
<a name="l00348"></a>00348   to_save-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#a8737ccbf4f03aa614e2fa7083d96727b" title="Saves the assignment to a file.">Save</a>(<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>.get());
<a name="l00349"></a>00349   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;mutable_worker_info()-&gt;set_worker_id(0);
<a name="l00350"></a>00350   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;set_is_valid(<span class="keyword">true</span>);
<a name="l00351"></a>00351   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Importing initial solution with value &quot;</span>
<a name="l00352"></a>00352           &lt;&lt; to_save-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#ae8fb42916395ec84bbc1c5a73838bb44">ObjectiveValue</a>();
<a name="l00353"></a>00353   BlockBarrier(&amp;solution_barrier_);
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 
<a name="l00356"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a31b6a1131bb7d3441f9b13435e997df6">00356</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a31b6a1131bb7d3441f9b13435e997df6" title="This method is used by the master to signal that no initial solution has been found.">MtSolveSupport::RegisterNoInitialSolution</a>() {
<a name="l00357"></a>00357   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;No initial solution found&quot;</span>;
<a name="l00358"></a>00358   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;clear_int_var_assignment();
<a name="l00359"></a>00359   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;clear_interval_var_assignment();
<a name="l00360"></a>00360   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;clear_objective();
<a name="l00361"></a>00361   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;mutable_worker_info()-&gt;set_worker_id(0);
<a name="l00362"></a>00362   <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;set_is_valid(<span class="keyword">false</span>);
<a name="l00363"></a>00363   BlockBarrier(&amp;solution_barrier_);
<a name="l00364"></a>00364 }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 <span class="keywordtype">bool</span> MtSolveSupport::CheckTermination() {
<a name="l00367"></a>00367   <span class="keywordflow">return</span> (ended_slaves_ == workers_ &amp;&amp;
<a name="l00368"></a>00368           best_exported_cost_ == <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;objective().min());
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 
<a name="l00371"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#ad31ae945c0f0c3c3a55f1afb680b960d">00371</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ad31ae945c0f0c3c3a55f1afb680b960d" title="Internal.">MtSolveSupport::MasterApplyReplayer</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00372"></a>00372                                          <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution) {
<a name="l00373"></a>00373   mutex_.Lock();
<a name="l00374"></a>00374   <span class="keywordflow">while</span> (best_exported_cost_ == <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;objective().min() &amp;&amp;
<a name="l00375"></a>00375          !CheckTermination()) {
<a name="l00376"></a>00376     master_blocked_ = <span class="keyword">true</span>;
<a name="l00377"></a>00377     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;master going into sleep&quot;</span>;
<a name="l00378"></a>00378     cond_var_.Wait(&amp;mutex_);
<a name="l00379"></a>00379   }
<a name="l00380"></a>00380   master_blocked_ = <span class="keyword">false</span>;
<a name="l00381"></a>00381   <span class="keywordflow">if</span> (CheckTermination()) {
<a name="l00382"></a>00382     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master failing after detecting termination&quot;</span>;
<a name="l00383"></a>00383     mutex_.Unlock();
<a name="l00384"></a>00384     s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();
<a name="l00385"></a>00385     <span class="comment">// Solver::Fail() will end up invoking Search::JumpBack() which does a</span>
<a name="l00386"></a>00386     <span class="comment">// longjmp, so the following code should never be executed.  We&#39;re careful</span>
<a name="l00387"></a>00387     <span class="comment">// to unlock the mutex before the call, since otherwise the mutex would be</span>
<a name="l00388"></a>00388     <span class="comment">// in an inconsistent state (i.e. it would be bad to have the mutex locked</span>
<a name="l00389"></a>00389     <span class="comment">// when we longjmp out of this context).  The call to lock the mutex is</span>
<a name="l00390"></a>00390     <span class="comment">// solely to appease annotalysis, and is correct in the event we do execute</span>
<a name="l00391"></a>00391     <span class="comment">// the following code.</span>
<a name="l00392"></a>00392     mutex_.Lock();
<a name="l00393"></a>00393   }
<a name="l00394"></a>00394   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master has received solution with objective value &quot;</span>
<a name="l00395"></a>00395           &lt;&lt; <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;objective().min() &lt;&lt; <span class="stringliteral">&quot; from worker &quot;</span>
<a name="l00396"></a>00396           &lt;&lt; <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;worker_info().worker_id();
<a name="l00397"></a>00397   fail_stamp_ = s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a0acf6942724a40e662a40df1f804eb51" title="The fail_stamp() is incremented after each backtrack.">fail_stamp</a>();
<a name="l00398"></a>00398   best_exported_cost_ = <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;objective().min();
<a name="l00399"></a>00399   solution-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#ae25cd4c0ce5b86a12bdf6b71e9f97201" title="Loads an assignment from a file; does not add variables to the assignment (only the variables contain...">Load</a>(*<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>);
<a name="l00400"></a>00400   mutex_.Unlock();
<a name="l00401"></a>00401   solution-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#a17a5e13f2f630fd1566794ac31087fb1">Restore</a>();
<a name="l00402"></a>00402   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master has successfully restored solution&quot;</span>;
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a9b3d746bcdab6c4f5ff00fa83f779fe0">00405</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a9b3d746bcdab6c4f5ff00fa83f779fe0">MtSolveSupport::MasterRefuteReplayer</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00406"></a>00406                                           <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution) {
<a name="l00407"></a>00407   <span class="keywordflow">if</span> (CheckTermination()) {
<a name="l00408"></a>00408     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master killing right branch after detecting termination&quot;</span>;
<a name="l00409"></a>00409     s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();
<a name="l00410"></a>00410   }
<a name="l00411"></a>00411 }
<a name="l00412"></a>00412 
<a name="l00413"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a5230b35e5d03927322889cbf5aadc810">00413</a> <a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a5230b35e5d03927322889cbf5aadc810">MtSolveSupport::MasterNextDecision</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00414"></a>00414                                              <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution) {
<a name="l00415"></a>00415   <span class="keywordflow">if</span> (CheckTermination()) {
<a name="l00416"></a>00416     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master not creating decision after detecting termination&quot;</span>;
<a name="l00417"></a>00417     s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();
<a name="l00418"></a>00418   }
<a name="l00419"></a>00419   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a0acf6942724a40e662a40df1f804eb51" title="The fail_stamp() is incremented after each backtrack.">fail_stamp</a>() == fail_stamp_) {
<a name="l00420"></a>00420     <span class="keywordflow">return</span> NULL;
<a name="l00421"></a>00421   } <span class="keywordflow">else</span> {
<a name="l00422"></a>00422     <span class="keywordflow">return</span> s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a01e1a27e5e6c03b48faab541885737ca" title="Registers the given object as being reversible.">RevAlloc</a>(<span class="keyword">new</span> <a class="code" href="classoperations__research_1_1MtReplaySolution.html" title="This class is used in the master search to replay the best solution so far in the apply branch...">MtReplaySolution</a>(<span class="keyword">this</span>, solution));
<a name="l00423"></a>00423   }
<a name="l00424"></a>00424 }
<a name="l00425"></a>00425 
<a name="l00426"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a962b1d0f7d9d69a10c216bb8845377ca">00426</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a962b1d0f7d9d69a10c216bb8845377ca">MtSolveSupport::SlaveExitSearch</a>(<span class="keywordtype">int</span> worker) {
<a name="l00427"></a>00427   {
<a name="l00428"></a>00428     MutexLock lock(&amp;mutex_);
<a name="l00429"></a>00429     ended_slaves_++;
<a name="l00430"></a>00430     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Slave &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; exiting!&quot;</span>;
<a name="l00431"></a>00431     <span class="keywordflow">if</span> (ended_slaves_ == started_slaves_ &amp;&amp; master_blocked_) {
<a name="l00432"></a>00432       VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Slave &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; awaking master&quot;</span>;
<a name="l00433"></a>00433       cond_var_.SignalAll();
<a name="l00434"></a>00434     }
<a name="l00435"></a>00435   }
<a name="l00436"></a>00436   BlockBarrier(&amp;exit_search_barrier_);
<a name="l00437"></a>00437   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Slave &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; after exit barrier&quot;</span>;
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2232e645164d443b5d6babb692201d22">00440</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2232e645164d443b5d6babb692201d22">MtSolveSupport::MasterEnterSearch</a>() {
<a name="l00441"></a>00441   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master before enter barrier&quot;</span>;
<a name="l00442"></a>00442   BlockBarrier(&amp;enter_search_barrier_);
<a name="l00443"></a>00443   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master after enter barrier&quot;</span>;
<a name="l00444"></a>00444 }
<a name="l00445"></a>00445 
<a name="l00446"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a662ed2e91422cafdc3d5e013d06914aa">00446</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a662ed2e91422cafdc3d5e013d06914aa">MtSolveSupport::MasterExitSearch</a>() {
<a name="l00447"></a>00447   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master before exit barrier&quot;</span>;
<a name="l00448"></a>00448   Reset();
<a name="l00449"></a>00449   BlockBarrier(&amp;exit_search_barrier_);
<a name="l00450"></a>00450   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Master after exit barrier&quot;</span>;
<a name="l00451"></a>00451 }
<a name="l00452"></a>00452 
<a name="l00453"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#aaf4ea3c5a9df67835824731f0fbf525f">00453</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#aaf4ea3c5a9df67835824731f0fbf525f">MtSolveSupport::SlaveEnterSearch</a>(<span class="keywordtype">int</span> worker) {
<a name="l00454"></a>00454   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Slave &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; before enter barrier&quot;</span>;
<a name="l00455"></a>00455   BlockBarrier(&amp;enter_search_barrier_);
<a name="l00456"></a>00456   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Slave &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; after enter barrier&quot;</span>;
<a name="l00457"></a>00457   {
<a name="l00458"></a>00458     MutexLock lock(&amp;mutex_);
<a name="l00459"></a>00459     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Slave &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; starting!&quot;</span>;
<a name="l00460"></a>00460     started_slaves_++;
<a name="l00461"></a>00461   }
<a name="l00462"></a>00462 }
<a name="l00463"></a>00463 
<a name="l00464"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#af33157d7b2315fd26838236bc8564da7">00464</a> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#af33157d7b2315fd26838236bc8564da7" title="Compare local solution with the shared one.">MtSolveSupport::IsSharedSolutionBetter</a>(int64 current_value)<span class="keyword"> const </span>{
<a name="l00465"></a>00465   <span class="keyword">const</span> int64 best_value = <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;objective().min();
<a name="l00466"></a>00466   <span class="keywordflow">return</span> (!<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a8517f7e6d446e2314f95565bf2550e4f" title="Are we maximizing.">maximize_</a> &amp;&amp; current_value &gt; best_value) ||
<a name="l00467"></a>00467       (<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a8517f7e6d446e2314f95565bf2550e4f" title="Are we maximizing.">maximize_</a> &amp;&amp; current_value &lt; best_value);
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00470"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae31e02a3d31836e432fdb886471db366">00470</a> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae31e02a3d31836e432fdb886471db366">MtSolveSupport::IsSharedSolutionWorse</a>(int64 current_value)<span class="keyword"> const </span>{
<a name="l00471"></a>00471   <span class="keyword">const</span> int64 best_value = <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;objective().min();
<a name="l00472"></a>00472   <span class="keywordflow">return</span> (!<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a8517f7e6d446e2314f95565bf2550e4f" title="Are we maximizing.">maximize_</a> &amp;&amp; current_value &lt; best_value) ||
<a name="l00473"></a>00473       (<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a8517f7e6d446e2314f95565bf2550e4f" title="Are we maximizing.">maximize_</a> &amp;&amp; current_value &gt; best_value);
<a name="l00474"></a>00474 }
<a name="l00475"></a>00475 
<a name="l00476"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#ada37e0fb50bc0a9b0004c57a4ea34891">00476</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ada37e0fb50bc0a9b0004c57a4ea34891">MtSolveSupport::SlaveNotifySolution</a>(<span class="keywordtype">int</span> worker,
<a name="l00477"></a>00477                                          <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution) {
<a name="l00478"></a>00478   MutexLock lock(&amp;mutex_);
<a name="l00479"></a>00479   <span class="keyword">const</span> int64 objective_value = solution-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#ae8fb42916395ec84bbc1c5a73838bb44">ObjectiveValue</a>();
<a name="l00480"></a>00480   VLOG(1) &lt;&lt; <span class="stringliteral">&quot;worker &quot;</span> &lt;&lt; worker
<a name="l00481"></a>00481           &lt;&lt; <span class="stringliteral">&quot; has found a solution with objective value &quot;</span> &lt;&lt; objective_value;
<a name="l00482"></a>00482   <span class="keywordflow">if</span> (<a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae31e02a3d31836e432fdb886471db366">IsSharedSolutionWorse</a>(objective_value)) {
<a name="l00483"></a>00483     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;  - solution accepted against &quot;</span>
<a name="l00484"></a>00484             &lt;&lt; <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;objective().min();
<a name="l00485"></a>00485     solution-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#a8737ccbf4f03aa614e2fa7083d96727b" title="Saves the assignment to a file.">Save</a>(<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>.get());
<a name="l00486"></a>00486     <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;mutable_worker_info()-&gt;set_worker_id(worker);
<a name="l00487"></a>00487     <a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#a00a047855d16a85ef2acd153585c9491" title="Best solution found so far.">local_solution_</a>-&gt;set_is_valid(<span class="keyword">true</span>);
<a name="l00488"></a>00488     <span class="keywordflow">if</span> (master_blocked_) {
<a name="l00489"></a>00489       VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Slave &quot;</span> &lt;&lt; worker &lt;&lt; <span class="stringliteral">&quot; awakening master after solution&quot;</span>;
<a name="l00490"></a>00490       cond_var_.SignalAll();
<a name="l00491"></a>00491     }
<a name="l00492"></a>00492   } <span class="keywordflow">else</span> {
<a name="l00493"></a>00493     VLOG(1) &lt;&lt; <span class="stringliteral">&quot;  - solution rejected against shared version&quot;</span>;
<a name="l00494"></a>00494   }
<a name="l00495"></a>00495 }
<a name="l00496"></a>00496 
<a name="l00497"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a95020cfa50666bf042f562030646c9cb">00497</a> <a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a95020cfa50666bf042f562030646c9cb" title="Creates a decision builder for the master.">MtSolveSupport::MakeReplayDecisionBuilder</a>(
<a name="l00498"></a>00498     <a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00499"></a>00499     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution) {
<a name="l00500"></a>00500   <span class="keywordflow">return</span> s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a01e1a27e5e6c03b48faab541885737ca" title="Registers the given object as being reversible.">RevAlloc</a>(<span class="keyword">new</span> <a class="code" href="classoperations__research_1_1MtReplayer.html" title="This decision builder replays the solutions found by the slaves.">MtReplayer</a>(s, <span class="keyword">this</span>, solution));
<a name="l00501"></a>00501 }
<a name="l00502"></a>00502 
<a name="l00503"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#adf300ee4f00170b7cb485150ac827398">00503</a> <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#adf300ee4f00170b7cb485150ac827398" title="A simple shortcut to create the search log only on the master.">MtSolveSupport::MakeSearchLog</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00504"></a>00504                                              <span class="keywordtype">bool</span> master,
<a name="l00505"></a>00505                                              int64 freq,
<a name="l00506"></a>00506                                              <a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> objective) {
<a name="l00507"></a>00507   <span class="keywordflow">if</span> (master) {
<a name="l00508"></a>00508     <span class="keywordflow">return</span> s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#ab430dded63bdb60330f9e312956c06f3" title="Search Log The SearchMonitors below will display a periodic search log on LOG(INFO) every branch_coun...">MakeSearchLog</a>(freq, objective);
<a name="l00509"></a>00509   } <span class="keywordflow">else</span> {
<a name="l00510"></a>00510     <span class="keywordflow">return</span> NULL;
<a name="l00511"></a>00511   }
<a name="l00512"></a>00512 }
<a name="l00513"></a>00513 
<a name="l00514"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#ad5551f220950e91a13a3104528566117">00514</a> <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ad5551f220950e91a13a3104528566117" title="Creates a search monitor that communicates solutions found by the slaves to the master.">MtSolveSupport::MakeCommunicationMonitor</a>(
<a name="l00515"></a>00515     <a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00516"></a>00516     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> solution, <span class="keywordtype">bool</span> master, <span class="keywordtype">int</span> worker) {
<a name="l00517"></a>00517   <span class="keywordflow">if</span> (master) {
<a name="l00518"></a>00518     <span class="keywordflow">return</span> s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a01e1a27e5e6c03b48faab541885737ca" title="Registers the given object as being reversible.">RevAlloc</a>(<span class="keyword">new</span> <a class="code" href="classoperations__research_1_1MtSolutionReceiver.html" title="This search monitor is used to synchronize the master and the slaves at the beginning of the search...">MtSolutionReceiver</a>(s, <span class="keyword">this</span>));
<a name="l00519"></a>00519   } <span class="keywordflow">else</span> {
<a name="l00520"></a>00520     <span class="keywordflow">return</span> s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a01e1a27e5e6c03b48faab541885737ca" title="Registers the given object as being reversible.">RevAlloc</a>(<span class="keyword">new</span> <a class="code" href="classoperations__research_1_1MtSolutionDispatcher.html" title="This class is used to to synchronize the master and the search at the beginning of the search...">MtSolutionDispatcher</a>(s, <span class="keyword">this</span>, solution, worker));
<a name="l00521"></a>00521   }
<a name="l00522"></a>00522 }
<a name="l00523"></a>00523 
<a name="l00524"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae1276216e0dc2e9cd262beb9991d276c">00524</a> <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae1276216e0dc2e9cd262beb9991d276c" title="A simple shortcut to create the limit only on the workers and not on the master.">MtSolveSupport::MakeLimit</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s,
<a name="l00525"></a>00525                                          <span class="keywordtype">bool</span> master,
<a name="l00526"></a>00526                                          int64 time_limit,
<a name="l00527"></a>00527                                          int64 branch_limit,
<a name="l00528"></a>00528                                          int64 fail_limit,
<a name="l00529"></a>00529                                          int64 solution_limit) {
<a name="l00530"></a>00530   <span class="keywordflow">if</span> (master) {
<a name="l00531"></a>00531     <span class="keywordflow">return</span> NULL;
<a name="l00532"></a>00532   } <span class="keywordflow">else</span> {
<a name="l00533"></a>00533     <span class="keywordflow">return</span> s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a2ac811ae585c1ef2d0ea35a42a72f3da" title="Limits the search with the &#39;time&#39;, &#39;branches&#39;, &#39;failures&#39; and &#39;solutions&#39; limits.">MakeLimit</a>(time_limit,
<a name="l00534"></a>00534                         branch_limit,
<a name="l00535"></a>00535                         fail_limit,
<a name="l00536"></a>00536                         solution_limit);
<a name="l00537"></a>00537   }
<a name="l00538"></a>00538 }
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 <span class="comment">// ----- Sharing Solution Pool -----</span>
<a name="l00541"></a>00541 
<a name="l00542"></a><a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html">00542</a> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html" title="Sharing Solution Pool.">MTSharingSolutionPool</a> : <span class="keyword">public</span> <a class="code" href="classoperations__research_1_1SolutionPool.html" title="SolutionPool.">SolutionPool</a> {
<a name="l00543"></a>00543  <span class="keyword">public</span>:
<a name="l00544"></a><a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#ae2fb72f1d6b9c5db75bfb748ea0c3807">00544</a>   <a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#ae2fb72f1d6b9c5db75bfb748ea0c3807">MTSharingSolutionPool</a>(<a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support, <span class="keywordtype">int</span> worker)
<a name="l00545"></a>00545       : reference_assignment_(NULL), support_(support), worker_(worker),
<a name="l00546"></a>00546         count_(0) {
<a name="l00547"></a>00547   }
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#a0ce6ffdcb024ca416e94dd2579d9e39c">00549</a>   <span class="keyword">virtual</span> <a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#a0ce6ffdcb024ca416e94dd2579d9e39c">~MTSharingSolutionPool</a>() {}
<a name="l00550"></a>00550 
<a name="l00551"></a><a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#a4a2f7a76c6e2e81b3b03a89daa8bb90f">00551</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#a4a2f7a76c6e2e81b3b03a89daa8bb90f" title="This method is called to initialize the solution pool with the assignment from the local search...">Initialize</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> assignment) {
<a name="l00552"></a>00552     reference_assignment_.reset(<span class="keyword">new</span> <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>(assignment));
<a name="l00553"></a>00553   }
<a name="l00554"></a>00554 
<a name="l00555"></a><a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#ae33f1832ae66437232209c7995b4dbb8">00555</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#ae33f1832ae66437232209c7995b4dbb8" title="This method is called when a new solution has been accepted by the local search.">RegisterNewSolution</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> assignment) {
<a name="l00556"></a>00556     reference_assignment_-&gt;Copy(assignment);
<a name="l00557"></a>00557   }
<a name="l00558"></a>00558 
<a name="l00559"></a><a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#a7a85fc94aba9e5a29eaf97fb37b2e25e">00559</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#a7a85fc94aba9e5a29eaf97fb37b2e25e" title="This method is called when the local search starts a new neighborhood to initialize the default assig...">GetNextSolution</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> assignment) {
<a name="l00560"></a>00560     <span class="keyword">const</span> int64 local_best = reference_assignment_-&gt;ObjectiveValue();
<a name="l00561"></a>00561     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#a91dfb33b24119c2195a4865174bdec8f" title="Locks the internal mutex.">LockMutex</a>();
<a name="l00562"></a>00562     AssignmentProto* <span class="keyword">const</span> best_solution = support_-&gt;<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#acc85a6eb86b33445e74fede5bfdb2f6c" title="Returns the best stored solution.">solution</a>();
<a name="l00563"></a>00563     <span class="keywordflow">if</span> (support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#af33157d7b2315fd26838236bc8564da7" title="Compare local solution with the shared one.">IsSharedSolutionBetter</a>(local_best)) {
<a name="l00564"></a>00564       VLOG(1) &lt;&lt; <span class="stringliteral">&quot;slave &quot;</span> &lt;&lt; worker_ &lt;&lt; <span class="stringliteral">&quot; import solution with value &quot;</span>
<a name="l00565"></a>00565               &lt;&lt; best_solution-&gt;objective().min() &lt;&lt; <span class="stringliteral">&quot; from &quot;</span>
<a name="l00566"></a>00566               &lt;&lt; best_solution-&gt;worker_info().worker_id();
<a name="l00567"></a>00567       reference_assignment_-&gt;Load(*best_solution);
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569     support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae5ce3e3e55087bedbe55e4345d7e8ca2" title="Unlocks the internal mutex.">UnlockMutex</a>();
<a name="l00570"></a>00570     assignment-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#a8640e47c57ef2d95a6c94d383a9641a4" title="Copies the intersection of the 2 assignments to the current assignment.">Copy</a>(reference_assignment_.get());
<a name="l00571"></a>00571   }
<a name="l00572"></a>00572 
<a name="l00573"></a><a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#a954dd5046529795b3bc1c34f50e5847b">00573</a>   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html#a954dd5046529795b3bc1c34f50e5847b" title="This method checks if the local solution needs to be updated with an external one.">SyncNeeded</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <span class="keyword">const</span> local_assignment) {
<a name="l00574"></a>00574     <span class="keywordflow">if</span> (++count_ &gt;= FLAGS_cp_parallel_update_frequency) {
<a name="l00575"></a>00575       count_ = 0;
<a name="l00576"></a>00576       <span class="keyword">const</span> int64 current_value = local_assignment-&gt;<a class="code" href="classoperations__research_1_1Assignment.html#ae8fb42916395ec84bbc1c5a73838bb44">ObjectiveValue</a>();
<a name="l00577"></a>00577       support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#a91dfb33b24119c2195a4865174bdec8f" title="Locks the internal mutex.">LockMutex</a>();
<a name="l00578"></a>00578       <span class="keywordtype">bool</span> result = support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#af33157d7b2315fd26838236bc8564da7" title="Compare local solution with the shared one.">IsSharedSolutionBetter</a>(current_value);
<a name="l00579"></a>00579       <span class="keywordflow">if</span> (result) {
<a name="l00580"></a>00580         VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Synchronizing current solution with value &quot;</span> &lt;&lt; current_value
<a name="l00581"></a>00581                 &lt;&lt; <span class="stringliteral">&quot; with foreign solution with value &quot;</span>
<a name="l00582"></a>00582                 &lt;&lt; support_-&gt;<a class="code" href="classoperations__research_1_1ParallelSolveSupport.html#acc85a6eb86b33445e74fede5bfdb2f6c" title="Returns the best stored solution.">solution</a>()-&gt;objective().min()
<a name="l00583"></a>00583                 &lt;&lt; <span class="stringliteral">&quot; for worker &quot;</span> &lt;&lt; worker_;
<a name="l00584"></a>00584       }
<a name="l00585"></a>00585       support_-&gt;<a class="code" href="classoperations__research_1_1MtSolveSupport.html#ae5ce3e3e55087bedbe55e4345d7e8ca2" title="Unlocks the internal mutex.">UnlockMutex</a>();
<a name="l00586"></a>00586       <span class="keywordflow">return</span> result;
<a name="l00587"></a>00587     } <span class="keywordflow">else</span> {
<a name="l00588"></a>00588       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00589"></a>00589     }
<a name="l00590"></a>00590   }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592  <span class="keyword">private</span>:
<a name="l00593"></a>00593   scoped_ptr&lt;Assignment&gt; reference_assignment_;
<a name="l00594"></a>00594   <a class="code" href="classoperations__research_1_1MtSolveSupport.html" title="Headers.">MtSolveSupport</a>* <span class="keyword">const</span> support_;
<a name="l00595"></a>00595   <span class="keyword">const</span> <span class="keywordtype">int</span> worker_;
<a name="l00596"></a>00596   <span class="keywordtype">int</span> count_;
<a name="l00597"></a>00597 };
<a name="l00598"></a>00598 
<a name="l00599"></a><a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2d6e2559008f09e5d97b9bdc3896e72c">00599</a> <a class="code" href="classoperations__research_1_1SolutionPool.html" title="SolutionPool.">SolutionPool</a>* <a class="code" href="classoperations__research_1_1MtSolveSupport.html#a2d6e2559008f09e5d97b9bdc3896e72c" title="Creates a solution pool to be used in the Local Search for each worker.">MtSolveSupport::MakeSolutionPool</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s, <span class="keywordtype">int</span> worker) {
<a name="l00600"></a>00600   <span class="keywordflow">return</span> s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#a01e1a27e5e6c03b48faab541885737ca" title="Registers the given object as being reversible.">RevAlloc</a>(<span class="keyword">new</span> <a class="code" href="classoperations__research_1_1MTSharingSolutionPool.html" title="Sharing Solution Pool.">MTSharingSolutionPool</a>(<span class="keyword">this</span>, worker));
<a name="l00601"></a>00601 }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603 }  <span class="comment">// namespace operations_research</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


  <!-- Start of footer. -->
  <table width=100% cellpadding=0 cellspacing=0 border=0>
    <tr valign=top>
      <td colspan=2 height=10></td>
    </tr>
    <tr valign=top>
      <td colspan=2 bgcolor=#992252 height=3></td>
    </tr>
  </table>

  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br />

  
  </body>
</html>
